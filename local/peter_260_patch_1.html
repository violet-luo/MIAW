<html>
  <style>
		body {
			background: url("https://esw1234.github.io/PeterC/images/ðŸ’» Home - Desktop.png") no-repeat;
		}
	</style>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, user-scalable=0">
<title>Neat Stuff MIAW Demo</title>
</head>
<body>

<p><a id="editThisPageLink" target="_blank" style="color:blue">Edit this page</a></p>
	
<script>document.getElementById('editThisPageLink').href = "https://github.com/ESW1234/esw1234.github.io/edit/master" + window.location.pathname;
	
window.addEventListener("onEmbeddedMessagingConversationStarted", (event) => {
	console.log("onEmbeddedMessagingConversationStarted event was fired.");
	console.log(event.detail);
});
window.addEventListener("onEmbeddedMessagingPreChatLoaded", (event) => {
	console.log("onEmbeddedMessagingPreChatLoaded event was fired.");
	console.log(event.detail);
});
window.addEventListener("onEmbeddedMessageDelivered", (event) => {
	console.log("onEmbeddedMessageDelivered event was fired.");
	console.log(event.detail);
});
</script>
	
<!-- <script type='text/javascript' src='https://service.force.com/asyncclient/bootstrap.js'></script> -->

<script type='text/javascript'>
	function initEmbeddedMessaging() {
		try {
			embeddedservice_bootstrap.settings.language = 'en'; // For example, enter 'en' or 'en-US'
			

			window.addEventListener("onEmbeddedMessagingReady", () => {
  				console.log("Received the onEmbeddedMessagingReady eventâ€¦");

				// Populating a variable with the current URL
				var currentURL = window.location.href;
				
				// Printing the current URL to the console
				console.log("Current URL:", currentURL);
				// Send data to Salesforce
    				embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({"PageURL" : currentURL});

				embeddedservice_bootstrap.prechatAPI.setVisiblePrechatFields({
				    // List the pre-chat field names with the value and whether it's editable in the pre-chat form.
				    "_firstName": {
				      "value": "Peter",
				      "isEditableByEndUser": true
				    },
				    "_lastName": {
				      "value": "Chung",
				      "isEditableByEndUser": true
				    },
				    "_email": {
				      "value": "pchung@salesforce.com",
				      "isEditableByEndUser": true
				    }
				});

  				embeddedservice_bootstrap.autoResponseAPI.setAutoResponseParameters({
    					cartValue: "123",
					country: "ch",
					language_code: "en",
					country_language: "ch-en",
					userName: "pchung@salesforce.com",
  				});
			});
			embeddedservice_bootstrap.settings.devMode = false;
			
			embeddedservice_bootstrap.init(
				'00DB0000000gb6A',
				'Peter_Messaging_for_Web_Demo',
				'https://orgfarm-47431d161c.my.site-com.pd6vkc6ihngz09xbtmcx8nq24.wc.crm.dev:6101/ESWMIAWChannel1764030740300',
				{
					scrt2URL: 'https://deevo-demo.my.salesforce-scrt.com'
				}
			);
		} catch (err) {
			console.error('Error loading Embedded Messaging: ', err);
		}
	};
</script>
<script type='text/javascript' src='https://orgfarm-47431d161c.my.site-com.pd6vkc6ihngz09xbtmcx8nq24.wc.crm.dev:6101/ESWMIAWChannel1764030740300/assets/js/bootstrap.js' onload='initEmbeddedMessaging()'></script>

  
</body>
</html>
